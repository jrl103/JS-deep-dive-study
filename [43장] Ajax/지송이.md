#43장 Ajax
=================================================================

# 43-1. Ajax 란?

#### Ajax (Asynchronous JavaScript and XML)
- `자바스크립트`를 사용하여 `브라우저가 서버에게 비동기 방식으로 데이터를 요청`하고, `서버가 응답한 데이터를 수신하여 웹페이지를 동적으로 갱신`하는 프로그래밍 방식
- 브라우저에서 제공하는 Web API 인 `XMLHttpRequest 객체를 기반으로 동작`함
  - `XMLHttpRequest` :: HTTP 비동기 통신을 위한 메서드와 프로퍼티를 제공
- 장점
  1. 변경할 부분을 갱신하는 데 필요한 데이터만 서버로부터 전송받기 때문에 --> `불필요한 데이터 통신 X`
  2. 변경할 필요가 없는 부분은 다시 렌더링 X --> `화면이 순간적으로 깜박이는 현상 X`
  3. 클라이언트와 서버와의 통신이 비동기 방식을 동작 --> `서버에게 요청을 보낸 이후 블로킹 X`


#### 이전의 웹페이지
- html 태그로 시작해서 html 태그로 끝나는 완전한 HTML 을 서버로부터 전송받아 `웹페이지 전체를 처음부터 다시 렌더링`하는 방식으로 동작함
- so, 화면이 전환되면 서버로부터 새로운 HTML 을 전송받아 웹페이지 전체를 처음부터 다시 렌더링했음
  - 단점
  1. 이전 웹페이지와 차이가 없어서, 변경할 필요가 없는 부분까지 포함된 완전한 HTML 을 서버로부터 매번 다시 전송받음 --> `불필요한 데이터 통신`
  2. 변경할 필요가 없는 부분까지 처음부터 다시 렌더링됨 --> `화면 전환시 화면 깜박임 현상`
  3. 클라이언트와 서버와의 통신이 동기 방식으로 동작하기 때문에, --> `서버로부터 응답이 있을 때까지 다음 처리가 블로킹됨`

# 43-2. JSON

#### JSON (JavaScript Object Notation)
- `클라이언트와 서버 간의 HTTP 통신`을 위한 `텍스트 데이터 포맷`
- 자바스크립트에 종속되지 않는 `언어 독립형 데이터 포맷`
- 대부분의 프로그래밍 언어에서 사용 가능

## 43-2-1. JSON 표기 방식

JSON : 자바스크립트의 객체 리터럴과 유사하게 `키와 값으로 구성된 순수한 텍스트`

```json
{
  "name": "Lee",
  "age": 20,
  "alive": true,
  "hobby": ["traveling", "tennis"]
}
```

- `JSON 키` : `반드시 큰따옴`표로 묶어야 함 (작은 따옴표 사용 불가)
- `JSON 값` : `객체 리터럴과 같은 표기법 그대로 사용 가능`. but, `문자열`은 반드시 `큰따옴표`로 묶어야 함 (작은 따옴표 사용 불가)

## 43-2-2. JSON.stringify

#### JSON.stringify 메서드
  - `객체를 JSON 포맷의 문자열로 변환`함
  - `클라이언트가 서버로 객체를 전송`하려면, `객체를 문자열화해야 함`
    - 이를 `직렬화(serializing)` 라고 함

```javascript
const obj = {
    name: 'Lee',
    age: 20,
    alive: true,
    hobby: ['traveling', 'tennis']
};

// 객체를 JSON 포맷의 문자열로 변환함
const json = JSON.stringify(obj);
console.log(typeof json, json);
// string {"name":"Lee", "age":20, "alive":true, "hobby":["traveling","tennis"]}

// 객체를 JSON 포맷의 문자열로 변환하면서 들여쓰기 함
const prettyJson = JSON.stringify(obj, null, 2);
console.log(typeof prettyJson, prettyJson);
/*
* string {
      "name": "Lee",
      "age": 20,
      "alive": true,
      "hobby": [
        "traveling", 
        "tennis"
      ]
  }
*/

// replacer 함수. 값의 타입이 Number 이면 필터링되어 반환 X
function filter(key, value) {
    // undefined: 반환 X
    return typeof value === 'number' ? undefined : value;
}

// JSON.stringify 메서드에 두 번째 인수로 replacer 함수를 전달함
const strFilteredObject = JSON.stringify(obj, filter, 2);
console.log(typeof strFilteredObject, strFilteredObject);
/*
* string {
      "name": "Lee",
      "alive": true,
      "hobby": [
        "traveling", 
        "tennis"
      ]
  }
*/
```

JSON.stringify 메서드는 `객체 뿐만 아니라`, `배열도 JSON 포맷의 문자열로 변환`함

```javascript
const todos = [
    { id: 1, content: 'HTML', completed: false},
    { id: 2, content: 'CSS', completed: true},
    { id: 3, content: 'JavaScript', completed: false},
];

// 배열을 JSON 포맷의 문자열로 변환함
const json = JSON.stringify(todos, null, 2);
console.log(typeof json, json);
/*
string [
    {
        "id": 1,
        "content": "HTML",
        "completed": false
    },    
    {
        "id": 2,
        "content": "CSS",
        "completed": true
    },    
    {
        "id": 3,
        "content": "JavaScript",
        "completed": false
    },
]
 */
```

## 43-2-3. JSON.parse

#### JSON.parse
- `JSON 포맷의 문자열을 객체로 변환`
- 서버로부터 클라이언트에게 전송된 JSON 데이터 : 문자열
  - 이 문자열을 객체로서 사용하려면 JSON 포맷의 문자열을 객체화 해야함 --> `역직렬화 : deserializing`

````javascript
const obj = {
    name: 'Lee',
    age: 20,
    alive: true,
    hobby: ['traveling', 'tennis']
};

// 객체를 JSON 포맷의 문자열로 변환함
const json = JSON.stringify(obj);

// JSON 포맷의 문자열을 객체로 변환함
const parsed = JSON.parse(json);
console.log(typeof parsed, parsed);
// object {name:"Lee", age:20, alive:true, hobby:["traveling","tennis"]}
````

- `배열이 JSON 포맷의 문자열로 변환되어 있는 경우`, JSON.parse 는 `문자열을 배열 객체로 변환`함
- `배열의 요소가 객체인 경우`, `배열의 요소까지 객체로 변환함`

```javascript
const todos = [
    { id: 1, content: 'HTML', completed: false},
    { id: 2, content: 'CSS', completed: true},
    { id: 3, content: 'JavaScript', completed: false},
];

// 배열을 JSON 포맷의 문자열로 변환함
const json = JSON.stringify(todos);

// JSON 포맷의 문자열을 배열로 변환함. 배열의 요소가 객체인 경우, 배열의 요소까지 객체로 변환함
const parsed = JSON.parse(json);
console.log(typeof parsed, parsed);
/*
object [
    { id: 1, content: "HTML", completed: false },    
    { id: 2, content: "CSS", completed: true },    
    { id: 3, content: "JavaScript", completed: false },    
]
 */
```

# 43-3. XMLHttpRequest

`브라우저`
- 주소창이나 HTML 의 form 태그 또는 a 태그를 통해 `HTTP 요청 전송 기능을 기본 제공`함

자바스크립트를 사용하여 HTTP 요청을 전송하려면 XMLHttpRequest 객체를 사용함






























